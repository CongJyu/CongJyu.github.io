---
layout: post
title: Make Mac Mini an RDP Server
date: 2026-01-24
author: Rain
tags:
  - 靈車漂移
  - Remote Desktop
  - macOS
---

# Make Mac Mini an RDP Server

> ⚠️ THIS POST HAS A "靈車漂移" TAG, AND DOES NOT GUARANTEE STABILITY.

## Background & Motivation

Recently Rain is using a combination of "separated" NAS and remote desktop, that is, an Intel NUC with a mounted external hard disk. It is worth attention that I want to have a user-friendly command line environment as well as a beautiful graphic user interface (GUI), so I installed a macOS Big Sur 11.9 on NUC, also called "Hacintosh". I will called it "Nucintosh" because it is installed on a NUC hardware.

It is generally acknowledge that macOS use ARD to connect from remote, and it does not support the RDP protocol form Microsoft. Rain wants to make Nucintosh be connected via RDP, so that maybe I can adjust the resolution settings from remote client. (not sure)

The method is to build an RDP server on macOS and make it run rdp services, and there is an open source solution called `xrdp` ([GitHub repo](https://github.com/neutrinolabs/xrdp)) but however it does not support macOS officially.

According to [some discussions](https://github.com/neutrinolabs/xrdp/issues/2194), there is a way to make Macs run `xrdp` and get remote connected.

## Compile XRDP

I choose `xrdp 0.9.19` version for this task. Someone said this version runs well on macOS Monterey. My Nucintosh runs a macOS Big Sur system, which is earlier than macOS Monterey, so it has a large probability to work with `xrdp 0.9.19` as well. Let us have a try.

### Prepare dependencies

We need these following dependencies:

- Xcode commandline tools
- Homebrew
- OpenSSL
- Automake and Autoconfig
- Libtool
- pkgconfig
- nasm
- XQuartz and its libs

If the machine do not have Homebrew installed, it is required to install one.

First, get Xcode command line tools ready.

```shell
xcode-select --install
```

Then install Homebrew.

```shell
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

It is also okay to have the macOS has MacPorts installed, like my Nucintosh, but it is also highly recommend to install Homebrew in this case. Some dependencies seem can only be installed from Homebrew, like XQuartz components.

Install `openssh`.

```shell
brew install openssh
```

Install `automake` and `autoconfig`.

```shell
brew install automake
```

Install `libtool`.

```shell
brew install libtool
```

Install `pkgconfig`.

```shell
brew install pkgconfig
```

Install `nasm`.

```shell
brew install nasm
```

Install XQuartz and its related libraries.

```shell
brew install xquartz
brew install libx11
brew install libxfixes
brew install libxrandr
```

Make sure all the dependencies above are installed.

### Get XRDP source code

All the operations are completed via terminal and CLI, so the only thing now I need to do is to download `xrdp 0.9.19` source code archive via command line. I use `wget` to do this.

```shell
wget "https://github.com/neutrinolabs/xrdp/releases/download/v0.9.19/xrdp-0.9.19.tar.gz"
```

If the system do not have a `wget` tool installed, we can install from Homebrew easily. (if neccessary)

```shell
brew install wget
```

Move this `tar` file to a coding place, for example, I put it in `~/Coding` directory.

```shell
mv xrdp-0.9.19.tar.gz ~/Coding
```

Use `tar` tool to extract the package.

```shell
tar -xvf xrdp-0.9.19.tar.gz
```

Then `cd` into the directory.

```shell
cd xrdp-0.9.19
```

### Compile and build

These steps are for x86_64 Macs.

Start.

```shell
./bootstrap
```

Configure the project. If the system does not have `pkgconfig` installed, it will throw an error out here.

```shell
./configure PKG_CONFIG_PATH=/opt/X11/lib/pkgconfig
```

Make and build.

```shell
make
```

Install `xrdp`.

```shell
sudo make install
```

The `xrdp` will be installed at `/usr/local/sbin/xrdp` by default.

## Settings for XRDP

Make sure `xrdp` is installed on macOS.

```shell
which xrdp
```

If the output is `/usr/local/sbin/xrdp`, then `xrdp` is installed correctly.

Generally, if no changes were made in source code before installation, the configuration file `xrdp.ini` will be stored at `/etc/rxdp`.

Use `vim` or other text editor to open it, with root privilige.

```shell
sudo vim /etc/xrdp/xrdp.ini
```

We need to change some of the configurations to make `xrdp` run correctly on macOS.

Find `[vnc-any]` line. The following lines are below:

```
[vnc-any]
name=vnc-any
lib=libvnc.so
ip=ask
port=5900
username=ask
password=ask
#pamusername=asksame
#pampassword=asksame
#pamsessionmng=127.0.0.1
#delay_ms=2000
```

We need to make some changes, like below.

```
[vnc-any]
name=vnc-any
lib=libvnc.dylib
ip=127.0.0.1
port=5900
username=ask
password=ask
#pamusername=asksame
#pampassword=asksame
#pamsessionmng=127.0.0.1
#delay_ms=2000
```

`lib` file should be `libvnc.dylib` on macOS instead of `libvnc.so` on Linux. `ip` should be set to `127.0.0.1` by default.

There are other session types, just comment them if not used, or they may cause some remote desktop client cannot connect successfully. Some clients may not display the `xrdp` portal correctly and lead to a crash.

After editting the configuration file, save changes and exit `vim`.

## Start XRDP services

Use root to run `xrdp`.

```shell
sudo /usr/local/sbin/xrdp
sudo /usr/local/sbin/xrdp-sesman
```

Or, if the directory is in the PATH,

```shell
sudo xrdp
sudo xrdp-sesman
```

## Connect from another machine

I use Remote Desktop Manager to connect Nucintosh remotely. After I added a RDP session, it connected successfully. `xrdp` works. However, I soon found that I still cannot adjust the resolution. It is a limitation from macOS, not from ARD.

## Conclusion

`xrdp` can work on macOS, making it possible to use RDP (including the built-in Remote Desktop on Windows) connect to Mac. RDP cannot realize the "dynamic resolution" on macOS and some Linux distros. These limitations are from the operating systems, not from remote desktop protocols.
